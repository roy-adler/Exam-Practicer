[
    {
        "id": "7g_001",
        "q": "What is one risk of storing secrets in Terraform state files?",
        "choices": [
            "They may be visible to all users with state file access",
            "They are automatically encrypted with AES-256 by default",
            "They cannot be accessed after apply",
            "They expire after 24 hours"
        ],
        "answer": [0],
        "explain": "Secrets stored in Terraform state files are visible in plaintext to anyone with access to the state file, posing a security risk.",
        "tags": ["terraform", "state", "secrets", "security", "plaintext"],
        "difficulty": "easy",
        "focus": "7g",
        "category": "Security",
        "multiple": false
    },
    {
        "id": "7g_002",
        "q": "Where does Terraform store sensitive data by default in the state file?",
        "choices": [
            "In plaintext",
            "Encrypted at rest",
            "Hashed with SHA-256",
            "Compressed and encoded"
        ],
        "answer": [0],
        "explain": "By default, Terraform stores sensitive data in plaintext within the state file, making it vulnerable to exposure.",
        "tags": ["terraform", "state", "sensitive", "plaintext", "default"],
        "difficulty": "easy",
        "focus": "7g",
        "category": "Security",
        "multiple": false
    },
    {
        "id": "7g_003",
        "q": "Which Terraform argument can you use to mark an output as sensitive?",
        "choices": [
            "sensitive = true",
            "secret = true",
            "hidden = true",
            "encrypt = true"
        ],
        "answer": [0],
        "explain": "The `sensitive = true` argument marks an output as sensitive, which masks its value in CLI output and logs.",
        "tags": ["terraform", "output", "sensitive", "argument", "masking"],
        "difficulty": "easy",
        "focus": "7g",
        "category": "Security",
        "multiple": false
    },
    {
        "id": "7g_004",
        "q": "If a secret value is marked as sensitive in Terraform, what effect does this have on CLI output?",
        "choices": [
            "It is masked in Terraform plan and apply outputs",
            "It is encrypted in the state file",
            "It cannot be used in other modules",
            "It prevents the value from being saved"
        ],
        "answer": [0],
        "explain": "Marking a value as sensitive masks it in CLI output, but it still appears in plaintext in the state file.",
        "tags": ["terraform", "sensitive", "cli", "output", "masking"],
        "difficulty": "medium",
        "focus": "7g",
        "category": "Security",
        "multiple": false
    },
    {
        "id": "7g_005",
        "q": "Which backend type can provide encryption-at-rest for state files without additional configuration?",
        "choices": [
            "S3 with SSE",
            "Local",
            "Consul",
            "None"
        ],
        "answer": [0],
        "explain": "S3 with Server-Side Encryption (SSE) provides encryption-at-rest for state files stored in S3 buckets.",
        "tags": ["terraform", "backend", "s3", "encryption", "sse"],
        "difficulty": "medium",
        "focus": "7g",
        "category": "Security",
        "multiple": false
    },
    {
        "id": "7g_006",
        "q": "What is the best way to prevent secret leakage in Terraform logs?",
        "choices": [
            "Mark variables or outputs as sensitive",
            "Store secrets in local variables",
            "Use base64 encoding",
            "Encrypt logs manually"
        ],
        "answer": [0],
        "explain": "Marking variables or outputs as sensitive prevents their values from appearing in Terraform logs and CLI output.",
        "tags": ["terraform", "logs", "sensitive", "variables", "outputs"],
        "difficulty": "medium",
        "focus": "7g",
        "category": "Security",
        "multiple": false
    },
    {
        "id": "7g_007",
        "q": "Which of the following is NOT a recommended practice for managing secrets in Terraform?",
        "choices": [
            "Use external secret stores like Vault",
            "Use plain text in .tfvars files committed to Git",
            "Mark outputs as sensitive",
            "Limit state file access"
        ],
        "answer": [1],
        "explain": "Storing secrets in plain text in .tfvars files that are committed to Git is a security risk and should be avoided.",
        "tags": ["terraform", "secrets", "tfvars", "git", "security"],
        "difficulty": "medium",
        "focus": "7g",
        "category": "Security",
        "multiple": false
    },
    {
        "id": "7g_008",
        "q": "If you store Terraform state in a remote backend, who can access secrets in that state?",
        "choices": [
            "Anyone with access to the backend storage",
            "Only the Terraform CLI",
            "Only the user who ran terraform apply",
            "Nobody"
        ],
        "answer": [0],
        "explain": "Anyone with access to the backend storage can potentially access secrets stored in the state file, highlighting the importance of proper access controls.",
        "tags": ["terraform", "backend", "state", "secrets", "access-control"],
        "difficulty": "medium",
        "focus": "7g",
        "category": "Security",
        "multiple": false
    },
    {
        "id": "7g_009",
        "q": "When using Terraform Cloud, how are sensitive values stored in the state file?",
        "choices": [
            "Encrypted at rest and masked in the UI",
            "Plaintext in the database",
            "Hashed with SHA-256 only",
            "Base64 encoded"
        ],
        "answer": [0],
        "explain": "Terraform Cloud encrypts sensitive values at rest and masks them in the user interface for enhanced security.",
        "tags": ["terraform", "cloud", "sensitive", "encryption", "ui"],
        "difficulty": "hard",
        "focus": "7g",
        "category": "Security",
        "multiple": false
    },
    {
        "id": "7g_010",
        "q": "How can you ensure that an input variable value is never written to the Terraform state file?",
        "choices": [
            "You cannot prevent it if it is used in a managed resource",
            "Set sensitive = true",
            "Store it in an environment variable",
            "Pass it via CLI"
        ],
        "answer": [0],
        "explain": "If a variable value is used in a managed resource, Terraform must store it in the state file to track the resource's current state.",
        "tags": ["terraform", "variables", "state", "resources", "limitation"],
        "difficulty": "hard",
        "focus": "7g",
        "category": "Security",
        "multiple": false
    }
]